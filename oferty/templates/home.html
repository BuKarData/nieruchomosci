<!DOCTYPE html>
<html lang="pl">
{% load static %}
{% load math_filters %}

<head>
  <meta charset="UTF-8">
  <title>BZBUD Deweloper Zielonka</title>
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
  />
  <style>
    body, html { margin:0; padding:0; height:100%; }
    .hero { display:flex; justify-content:center; align-items:center; flex-direction:column; text-align:center; }

    .status-dostępne { color: green; font-weight:bold; }
    .status-rezerwacja { color: orange; font-weight:bold; }
    .status-sprzedane { color: red; font-weight:bold; }

    .oferta-card { display:flex; flex-direction:row; gap:20px; margin-bottom:30px; flex-wrap:wrap; }
    .oferta-body { flex:1 1 300px; }
    .oferta-image { flex:0 0 350px; display:flex; justify-content:center; align-items:center; padding:12px; }
    .oferta-img { width:100%; max-width:320px; height:auto; object-fit:cover; border-radius:5px; box-shadow:0 2px 6px rgba(0,0,0,0.2); margin:0 10px; }

    .btn-hover-fill:hover { background-color:#0056b3; border-color:#0056b3; color:#fff; transition:0.3s; }
  </style>
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light mb-4 shadow-sm">
    <div class="container-fluid">
      <a class="navbar-brand" href="{% url 'home' %}">BZBUD</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link fw-bold" href="{% url 'home' %}">Strona główna</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{% url 'lista_ofert' %}">Oferta</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-5">
    <h1 class="text-center">BZBUD</h1>
    <p class="text-center text-muted">
      STRONA W BUDOWIE - OFERTY TESTOWE - Budujemy Twój komfort.
    </p>

    <h1 class="text-center mb-4">Nasze inwestycje</h1>
    <h1>Inwestycje</h1>

    <h1 class="text-center mb-4">Nasze inwestycje</h1>

{% for inwestycja in inwestycje %}
<div class="inwestycja-box">
  <h2>{{ inwestycja.nazwa }}</h2>
  <p>{{ inwestycja.adres }}</p>
  <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#inwestycjaModal{{ inwestycja.id }}">
    Szczegóły inwestycji
  </button>

  <!-- Modal -->
  <div class="modal fade" id="inwestycjaModal{{ inwestycja.id }}" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Oferty w {{ inwestycja.nazwa }}</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zamknij"></button>
        </div>
        <div class="modal-body">
          {% if inwestycja.oferty.all %}
            <ul class="list-group">
              {% for oferta in inwestycja.oferty.all %}
              <li class="list-group-item">
                <strong>{{ oferta.adres }}</strong> – {{ oferta.metraz }} m², {{ oferta.pokoje }} pok.
                <span class="badge bg-secondary">{{ oferta.get_status_display }}</span>
                <br>
                {% if oferta.ceny.exists %}
                  {% with ostatnia=oferta.ceny.last %}
                    Cena: {{ ostatnia.kwota|floatformat:0 }} zł ({{ ostatnia.data }})
                    {% if oferta.metraz %}
                      – {{ ostatnia.kwota|div:oferta.metraz|floatformat:0 }} zł/m²
                    {% endif %}
                  {% endwith %}
                {% else %}
                  Brak ceny
                {% endif %}
              </li>
              {% endfor %}
            </ul>
          {% else %}
            <p>Brak ofert dla tej inwestycji.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% empty %}
<p>Brak inwestycji</p>
{% endfor %}

    
    <script>
    function showPopup(id){
        document.getElementById(id).style.display = 'block';
    }
    function hidePopup(id){
        document.getElementById(id).style.display = 'none';
    }
    </script>
    
    <style>
    .inwestycja-box { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
    .popup { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); }
    .popup-content { background: #fff; margin: 10% auto; padding: 20px; width: 60%; position: relative; }
    .close { position: absolute; top: 10px; right: 20px; font-size: 24px; cursor: pointer; }
    </style>
    
    <div class="text-center mt-4">
      <a href="{% url 'lista_ofert' %}" class="btn btn-primary btn-lg btn-hover-fill">Zobacz inne oferty</a>
    </div>

    <!-- Sekcja "O nas" -->
    <section class="container my-5 py-5 bg-light rounded shadow-sm">
      <div class="row align-items-center">
        <div class="col-md-6 mb-4 mb-md-0">
          <h2 class="mb-3">O nas</h2>
          <p class="lead">
            Rodzinna firma z Zielonki. Od lat budujemy komfortowe i nowoczesne
            mieszkania oraz domy, stawiając na jakość i zadowolenie naszych klientów.
          </p>
        </div>
        <div class="col-md-6 text-center">
          <img src="{% static 'BZBUD.png' %}" alt="O nas" class="img-fluid rounded shadow-sm" style="max-height:300px; object-fit:cover">
        </div>
      </div>
    </section>

    <div style="position: fixed; bottom: 10px; right: 10px; background: rgba(255,255,255,0.9); padding:12px 18px; border:1px solid #ddd; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.2); font-size:14px; line-height:1.4;">
      <strong>Kontakt:</strong><br>
      tel: +48 696 362 748<br>
      email: beatazochowska8@gmail.com
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
</body>
</html>
